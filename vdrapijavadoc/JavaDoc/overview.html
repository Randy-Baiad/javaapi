<HTML>
<HEAD>
<TITLE>U.G.: ViewDirect API for Java</TITLE>
</HEAD>
<BODY LINK="#0000ff" VLINK="#800080">


<FONT FACE="Arial"><H1><A NAME="Heading8"><A NAME="_Toc508756843"></A></A>ViewDirect API for Java - Overview</H1>
<p><tt><font face="arial">
<ul><li>Click <A HREF="index.html">here</A> for access to the ViewDirect API for Java classes documentation.
<li>Click <a href="javaapiwn.html">here</a> to view the ViewDirect API for Java on Windows installation instructions.
<li>Click <a href="javaapisol.html">here</a> to view the ViewDirect API for Java on Solaris installation instructions.
</ul>

<h2>Contents</h2>
<p></p>
<a href="#Introduction">Introduction</a><br>
<a href="#_Toc508756848">Factory Classes</a><br>
<a href="#_Toc508756849">Node Classes</a><br>
<a href="#_Toc508756850">IPage and IPageView Interfaces</a><br>
<a href="#_Toc508756851">Commands</a><br>
<a href="#_Toc508756852">Navigation</a><br>
<a href="#_Toc508756857">Using the Enterprise Query Facility</a><br>
<a href="#_Toc508756859">Using the Enhanced Topic Item Search and Filter Query Facility</a><br>
<a href="#_Toc508756858">Error Handling</a><br>
<a href="#appsetup">Setup Verification</a><br>
<a href="#Migration21to42">Migrating from ViewDirect API for Java version 2.1 to version 4.2</a>



<a name="Introduction"></a><h2>Introduction</h2>

<P>Distributed object technology is well-suited for creating flexible client/server systems, because the data and business logic are encapsulated within objects, allowing them to be located anywhere within a distributed environment. Distributed objects enable granular components to be visually assembled via tools, operate across networks, run on different platforms, roam on networks, and coexist with legacy applications through object wrappers. This flexibility is why enterprises use distributed objects for building component-based Web applications. Objects packaged as components provide the ideal infrastructure for delivering robust client/server systems in a distributed environment. </P>
<P>Enterprises are focusing on Customer Relationship Management initiatives, including integrating front office and back-office systems, making all enterprise content available to customers, and building component-based Web applications. These Web applications usually need to run on a distributed platform, such as Sun Solaris, IBM AIX, HP-UX, Windows NT, or Linux. </P>
<P>The ViewDirect API for Java helps you build powerful, scalable, and interactive Web applications. You can give your employees, customers, and business partners access to all the content stored in either ViewDirect for Networks or ViewDirect for MVS. For example, insurance agents can access their enterprise portal to retrieve commission reports and view customer insurance policies, premiums paid, and claim forms. The ViewDirect API for Java allows you to customize
your Web application any way you choose, giving you complete flexibility in determining how your users can access information.
<p>There are a number of ways you can call the ViewDirect API for Java. The figure below illustrates some of these methods, including: </P>

<UL>
<LI>Servlets. You can write your own servlet to call all the API functions. </LI>
<LI>Java Server Pages. You can write your own Java Server Page (JSP) to call the API. </LI>
<LI>Enterprise Java Beans. You can call all the API functions from an Enterprise Java Bean (EJB). </LI>
<LI>Any Java application. You can use any Java application to call the functions. </LI></UL>

</FONT><P><IMG SRC="java.gif"</P>
<B><FONT FACE="Arial"><P>Examples of Calling the ViewDirect API for Java</B> </P>
<P>Your custom code can reside on any platform, while the Mobius code can reside on Sun Solaris or Windows NT. Other platforms will be supported in the future. </P>
<H3><A NAME="Heading27"><A NAME="_Toc508756845"></A></A>Components, Packages, and JAR Files</H3>
<P><div>The public ViewDirect API is encapsulated within the com.mobius.vdrapi package and its sub-packages.<BR>
</div></P>
<H3><A NAME="Heading29"><A NAME="_Toc508756846"></A></A>Documentation</H3>
<P><div>In addition to this documentation, </FONT><A HREF="index.html"><FONT FACE="Arial">a complete set of HTML javadoc files</FONT></A><FONT FACE="Arial"> is provided. It documents every public class and interface defined by the ViewDirect API for Java.<BR>
</div></P>
<H3><A NAME="Heading31"><A NAME="_Toc508756847"></A></A>API Objects</H3>
<P><div>The ViewDirect API for Java includes the following basic types of objects and interfaces: <I>factories;</I> <I>nodes;</I> objects that implement the <I>IPage</I> and <I>IPageView</I> interfaces; and <I>commands</I>. These basic object types provide the entire functionality of the API. The following discussion describes these classes at a high level only. A more detailed description of the classes defined in the API is provided in the javadoc files themselves.<BR>
</div></P>
<H3><A NAME="Heading33"><A NAME="_Toc508756848"></A></A>Factory Classes</H3>
<P><div>Factory classes are classes that create objects, lists of objects, or other factories. There are five fundamental factory classes:<BR>
</div></P>
<I><H4><A NAME="Heading35"></A>DocumentServerFactory</H4>
<P><div></I>The DocumentServerFactory class is used to create and maintain lists of document servers. A DocumentServerFactory object can be used to:<BR>
</div></P>

<UL>
<LI>Create a list of document servers (objects implementing the IDocumentServer interface) based on query parameters. The document server information is extracted from the Windows INI file or Unix REG file (which contains the user profile). </LI>
<LI>Create a new document server definition and place it in the user profile. </LI>
<LI>Remove a document server from the user profile and the internal list.</LI></UL>

<I><H4><A NAME="Heading40"></A>Session</H4>
<P><div></I>The Session class represents a connection with one or more document servers. A session object can be used to:<BR>
</div></P>

<UL>
<LI>Establish connections with document servers. </LI>
<LI>Terminate previously established document server connections. </LI>
<LI>Create a ReportListFactory, a TopicListFactory, or a SearchTopicitemsListFactory.</LI></UL>

<I><H4><A NAME="Heading45"></A>ReportListFactory</H4>
<P><div></I>The ReportListFactory class facilitates the creation of a list of reports (based upon query parameters) for the document servers to which the session that created the ReportListFactory object is connected. The returned list of ReportNode objects combines the information from all connected servers.<BR>
</div></P>
<I><H4><A NAME="Heading47"></A>TopicListFactory</H4>
<P><div></I>The TopicListFactory class facilitates the creation of a list of Topics (based upon query parameters) for the document servers to which the session that created the TopicListFactory object is connected. The returned list of TopicNodes combines the information from all connected servers.<BR>
</div></P>
<I><H4><A NAME="Heading49"></A>SearchTopicitemsListFactory</H4>
<P><div></I>The SearchTopicitemsListFactory facilitates the creation of a list of pages (based upon query parameters) for the document servers to which the session that created the SearchTopicitemsListFactory object is connected. Each page in the list is represented by a SearchTopicItemNode object. The returned list of SearchTopicItemNodes combines the information from all connected servers.<BR>
</div></P>
<H3><A NAME="Heading51"><A NAME="_Toc508756849"></A></A>Node classes</H3>
<P><div>Consider the reports and topics stored on a document server within the context of a tree hierarchy. The <I>node classes </I>represent individual entries within that tree hierarchy, and include the following:</P></FONT>
<TABLE CELLSPACING=0 BORDER=0 CELLPADDING=7 WIDTH=638>
<TR><TD WIDTH="30%" VALIGN="TOP"><tt>
<P><FONT FACE="Arial">ReportNode</FONT></TD>
<TD WIDTH="70%" VALIGN="TOP"><tt>
<FONT FACE="Arial"><P>- represents a report</FONT></TD>
</TR>
<TR><TD WIDTH="30%" VALIGN="TOP"><tt>
<FONT FACE="Arial"><P>ReportVersionNode</FONT></TD>
<TD WIDTH="70%" VALIGN="TOP"><tt>
<FONT FACE="Arial"><P>- represents a report version</FONT></TD>
</TR>
<TR><TD WIDTH="30%" VALIGN="TOP"><tt>
<FONT FACE="Arial"><P>ReportSectionNode</FONT></TD>
<TD WIDTH="70%" VALIGN="TOP"><tt>
<FONT FACE="Arial"><P>- represents a report section</FONT></TD>
</TR>
<TR><TD WIDTH="30%" VALIGN="TOP"><tt>
<FONT FACE="Arial"><P>ReportPageNode</FONT></TD>
<TD WIDTH="70%" VALIGN="TOP"><tt>
<FONT FACE="Arial"><P>- represents a report page</FONT></TD>
</TR>
<TR><TD WIDTH="30%" VALIGN="TOP"><tt>
<FONT FACE="Arial"><P>TopicNode</FONT></TD>
<TD WIDTH="70%" VALIGN="TOP"><tt>
<FONT FACE="Arial"><P>- represents a topic</FONT></TD>
</TR>
<TR><TD WIDTH="30%" VALIGN="TOP"><tt>
<FONT FACE="Arial"><P>TopicVersionNode</FONT></TD>
<TD WIDTH="70%" VALIGN="TOP"><tt>
<FONT FACE="Arial"><P>- represents a topic version</FONT></TD>
</TR>
<TR><TD WIDTH="30%" VALIGN="TOP"><tt>
<FONT FACE="Arial"><P>TopicItemNode</FONT></TD>
<TD WIDTH="70%" VALIGN="TOP"><tt>
<FONT FACE="Arial"><P>- represents a topic item</FONT></TD>
</TR>
<TR><TD WIDTH="30%" VALIGN="TOP"><tt>
<FONT FACE="Arial"><P>TopicReportNode</FONT></TD>
<TD WIDTH="70%" VALIGN="TOP"><tt>
<FONT FACE="Arial"><P>- represents a topic report</FONT></TD>
</TR>
<TR><TD WIDTH="30%" VALIGN="TOP"><tt>
<FONT FACE="Arial"><P>TopicReportVersionNode</FONT></TD>
<TD WIDTH="70%" VALIGN="TOP"><tt>
<FONT FACE="Arial"><P>- represents a topic report version</FONT></TD>
</TR>
<TR><TD WIDTH="30%" VALIGN="TOP"><tt>
<FONT FACE="Arial"><P>TopicSectionNode</FONT></TD>
<TD WIDTH="70%" VALIGN="TOP"><tt>
<FONT FACE="Arial"><P>- represents a topic section</FONT></TD>
</TR>
<TR><TD WIDTH="30%" VALIGN="TOP"><tt>
<FONT FACE="Arial"><P>SearchTopicItemNode</FONT></TD>
<TD WIDTH="70%" VALIGN="TOP"><tt>
<FONT FACE="Arial"><P>- represents a report page satisfying a search topic query</FONT></TD>
</TR>
<TR><TD WIDTH="30%" VALIGN="TOP"><tt>
<FONT FACE="Arial"><P>DocumentServer</FONT></TD>
<TD WIDTH="70%" VALIGN="TOP"><tt>
<FONT FACE="Arial"><P>- abstract class to represent a document server</FONT></TD>
</TR>
</TABLE>

<FONT FACE="Arial"><P>
</div>All the node classes, with the exception of the DocumentServer class, are themselves factories; that is, they contain methods that allow the construction of objects, or lists of objects, that exist at the next lower level in the hierarchy. For example, the ReportNode is a <I>report version factory</I>, because its CreateList method returns a list of ReportVersionNode items (based upon query parameters). Similarly, the ReportSectionNode is a <I>report page factory</I>, because its CreateList method returns a list of ReportPageNode items (based upon query parameters). </div><div><BR>
The ReportPageNode (created by either a ReportSectionNode or a TopicSectionNode) and the SearchTopicItemNode (created by a SearchTopicItemFactory) each represent an actual page of a report. They are also factories, but in a different sense from the other nodes; each is a <I>Page factory</I>, meaning they include a CreatePage method that constructs a single object (not a list) that implements the IPage interface. This IPage object allows the manipulation of the actual page data. Additionally, the SearchTopicItemNode allows the retrieval of the report information and topic information that corresponds to this node.</div> <div><BR>
The DocumentServer class is an abstract class used to represent a document server. There are specific classes for the different communications protocols that are supported. Among its other capabilities, the DocumentServer class provides a mechanism for changing a server’s password, as well as for configuring various aspects of the server, for example, the recipient ID, password, and various protocol-specific parameters of the server.</P>
<P>The node classes are particularly useful for navigating through the report and topic hierarchies in document servers. For details, see the <B>Navigation</B> section.</P>
<P>Every node contains methods for retrieving information pertinent to that node. </P>

<H3><A NAME="_Toc508756850"></A></A>IPage and IPageView Interfaces</H3>
<P>Objects implementing the IPage and IPageView interfaces allow the manipulation of the report page data and its view.
Factories that create objects implementing the IPage interface include ReportPageNode and SearchTopicItemNode.
<p>An object implementing the IPage interface encapsulates report page data. It provides methods for retrieving information about the page,
including the page class name and the page class version. In addition, the IPage interface provides a method to return the
actual raw, unrendered data of the page.
<p>An object implementing the IPage class is also a <I>page view factory</I>. It provides a method for creating an object that implements the IPageView interface. An object implementing the IPageView interface represents a view for a given page. The same IPage object can be used to create multiple IPageView objects, each representing a different view of the page data. The objects implementing the IPageView interface provide methods to manipulate the view of the page data, including methods for rotation, scaling, and rendering of the data.
<p>An object implementing the IPageView interface for a graphical report page can be rotated, scaled, rendered, and rendered to a stream.
<p>An object implementing the IPageView interface for a text report page can be rendered, rendered to a stream, and have its font and font color changed. It can not be rotated or scaled.
<p>An object implementing the IPageView interface for an external report page can be rendered to a stream. It can not be directly rendered, nor can it be rotated or scaled.
<p>An object implementing the IPageView interface must be queried to determine its capabilities. For example:<div><BR>
</FONT><TT>IPage viewOfPage ; // assume this contains a valid IPage object.</TT><FONT FACE="Arial"><BR>
</FONT><TT>if ( viewOfPage instanceof ICanRotate) // Can this page can be rotated?</TT><FONT FACE="Arial"><BR>
</FONT><TT>{</TT><FONT FACE="Arial"> <BR>
</FONT><TT>&nbsp;&nbsp; ((ICanRotate)viewOfPage).rotate( 90 ); // If so, rotate it 90 degrees.</TT><FONT FACE="Arial"><BR>
</FONT><TT>}</TT><FONT FACE="Arial"><BR>
</div></P>
<H3><A NAME="Heading84"><A NAME="_Toc508756851"></A></A>Commands</H3>
<P><div><I>Commands </I>are objects that perform operations that fall outside the scope of the factory, node, IPage, and IPageView objects described above. Commands are scriptable, meaning that they can be written to disk and played back at a later time.<BR>
</div></P>
<I><H4><A NAME="Heading86"></A>Types of commands</H4>
</I><P>The LocateNode command is used to locate a node in the topic or report hierarchy for a document server. Effectively, this command programmatically navigates the topic or report hierarchy to find the requested node.</div> <div><BR>
The CreatePageGroup command is used to gather groups of pages, change their output format, and write the results to a stream. The caller can specify the page range that will form the output. Optional parameters allow the caller to specify (1)the output format; (2)if the output should be compressed; or (3) a policy and policy group to be used.
<p><a href="downopts.html">View the complete list of available page input and output format options.</a>
</div> <div>
<p>The GoToPage command allows the direct retrieval of a report page. Executing a GoToPage command returns an object that implements the IPage interface. This is more efficient than using the LocateNode command to retrieve a page, or explicitly navigating to the page in question using the node objects and factories described above. <BR>
<br>The Find command object is used to find text on a page. It searches the current page and tries to locate the specific text. If this page doesn't have the text, it will locate the page that does. </div><div><BR>
</P>
<I><H4><A NAME="locnod"></A>Using Command Objects</H4>
<P><div></I>Command object creation requires the following steps:<BR>
</div></P>
<OL>

<LI>Instantiate a new command object. Use the constructor’s parameters to set any callback interfaces the command might need. </LI>
<LI>Use the object’s access methods to set any additional callback interfaces. </LI>
<LI>Create a list of parameters in string form (key/value pairs) that the command requires. </LI>
<LI>Load the parameter list into the command, using the command’s Load method. </LI>
<LI>Execute the command.</LI></OL>

<p><a href="locnodex.html">View an example of standard object creation using the LocateNode command.</a>

</FONT>

<FONT FACE="Arial"><p>
</div>

<H3><A NAME="_Toc508756852"></A>Navigation</H3>
<P>Navigate through report and topic tree hierarchies using the factory and node classes provided in the API.<BR>
</P>
<H4><A NAME="_Toc508756853"></A>The DocumentServerFactory and DocumentServer classes</H4>
<P>The first step in navigation is the creation of a DocumentServerFactory object. Once you have created a DocumentServerFactory object,
you can use it to obtain a list of DocumentServer objects identifying the servers defined in the user’s profile. For example, to obtain a list of all the servers:<BR><br>
</FONT><TT>// Create a DocumentServerFactory object. Note that objectWithProfile is an object that
implements the IhasProfileLocation interface.</TT><FONT FACE="Arial"><BR>
</FONT><TT>DocumentServerFactory dsf = new DocumentServerFactory(objectWithProfile) ;</TT><FONT FACE="Arial"><BR>
<BR>
</FONT><TT>// Get a list of servers from the factory. Create a query parameter that indicates we want</TT><FONT FACE="Arial"><BR>
</FONT><TT>// all matches. We’ll specify 999 as the maximum returned number of matches.</TT><FONT FACE="Arial"><BR>
</FONT><br><TT>DocumentServerQueryParam dsqp = new DocumentServerQueryParam( "", ComparisonSpec.GreaterThanOrEqualTo, 999,
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SortOrder.Ascending, null ) ;</TT><FONT FACE="Arial"><BR>
<FONT FACE="Arial"><BR>
</FONT><TT>INode [] ds = dsf.createList( dsqp );</TT><FONT FACE="Arial"><BR>
</div><BR>
</P></font>

<p>A user profile can contain various document server types, including TCP/IP, Remote, HLLAPI or CPIC document servers.
You can also use the DocumentServerQueryParam object to retrieve a specific type(s) of document servers from a
user profile. The following example retrieves remote document servers only from the profile:
<br>
<p><TT>Vector typesAllowed = new Vector();</TT><br>
<TT>typesAllowed.add(DocumentServerProtocol.RPC);</P>

</FONT><TT>// Get a list of servers from the factory. Create a query parameter that indicates we want</FONT></TT><BR>
</FONT><TT>// all remote servers. We’ll specify 10 as the maximum returned number of matches.
Also sort the // returned list in ascending order. </FONT></TT><BR><br>
</FONT><TT>DocumentServerQueryParam dsqp = new DocumentServerQueryParam(&quot;&quot;, ComparisonSpec.GreaterThanOrEqualTo,
10,<br>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SortOrder.Ascending, typesAllowed</FONT><TT>);</FONT></TT><BR>
<BR>
</FONT><TT>INode [] ds = dsf.createList( dsqp );</P>
</FONT></TT>

<h4><font face="arial"><a name="retrieve"></a>Retrieving Document Server Properties</h4>

<P>Document server properties are also stored in the user profile. You can use the array of INode objects
returned from the createList method in DocumentServerFactory to retrieve the properties of the
different types of document servers.</P>

<p><a href="docsrvex.html">View an example of retrieving the properties of all TCP/IP and
Remote document servers defined in the user profile.</a>


<a name="config"></a><h4>Configuring Document Servers</h4>

<P>The DocumentServerFactory object can also be used to create or configure new document server(s) in the profile.</P>

<tt>// Create a DocumentServerFactory object, objectWithProfile is an object that implements the IHasProfileLocation interface</tt>
<br><br>
<tt>DocumentServerFactory dsf = new DocumentServerFactory(objectWithProfile);</tt>

<p><a href="docsrvex.html#remote">View an example of configuring a new Remote document server.</a><br>
<a href="docsrvex.html#TCPIP">View an example of configuring a new TCP/IP document server.</a>


<H4><FONT FACE="Arial"><A NAME="Heading176"></A>The Session Class</H4>
<P><div>Once a list of servers has been retrieved, you can establish a session with any one or more of these servers as follows:</div> <div><BR>
</FONT><TT>// This command establishes a session with the third document server in the list of retrieved servers.</TT><FONT FACE="Arial"><BR>
</FONT><TT>Session sess = new Session((IDocumentServer)ds[ 2 ], recipientid, password, securityInfo, traceThreshold );</TT><FONT FACE="Arial"><BR>
<BR>
</FONT><TT>// Using this same session, you can also establish a connection with the fourth document server in</TT><FONT FACE="Arial"><BR>
</FONT><TT>// the list.</TT><FONT FACE="Arial"><BR>
</FONT><TT>sess.attach( (IDocumentServer)ds[ 3 ], recipientid, password );</TT><FONT FACE="Arial"><BR>
</div><div><BR>
</div><div>The above example exposes a special feature of sessions, namely, that a session can represent a connection to multiple
document servers.  If you only need a single document server connection, calling the attach method is not required, as the Session
constructor will create the connection for a single document server.<BR>
</div><div><p>Having established a session, you can use it to create a report list factory or a topic list factory, which allow you to
navigate their respective hierarchies. You can also use the session to create a search topic item list factory
(which encapsulates the Enterprise Query Facility) for obtaining a list of pages matching search criteria.<BR>
</div></P>

<H4><A NAME="Heading187"><A NAME="_Toc508756855"></A></A>Navigating the Report Hierarchy</H4>

<P><div>To navigate the report hierarchy, first create a report list factory:<BR><br>
</FONT><TT>// Create a report list factory.</TT><FONT FACE="Arial"><BR>
</FONT><TT>ReportListFactory rlf = (ReportListFactory)(sess.createListFactory( SessionFactoryType.Report ));</TT><FONT FACE="Arial"><BR>
<BR>
</div><div>Having obtained the factory, you can now use it to perform navigation. Use the report list factory to obtain a list of all
reports for all the document servers to which the session is connected:<BR><br>
</FONT><TT>// Get a list of all reports on the servers.</TT><FONT FACE="Arial"><BR>
</FONT><TT>QueryParam query = new QueryParam("", ComparisonSpec.GreaterThanOrEqualTo, 99999) ;</TT><FONT FACE="Arial"><BR>
</FONT><TT>INode [] rn = rlf.createList( query );</TT><FONT FACE="Arial"><BR>
<BR>
The ReportNode is a report version list factory. Use it to obtain a list of all versions for one of the reports:<BR>
<BR>
</FONT><TT>// Get a list of all versions on the report at index 3.</TT><FONT FACE="Arial"><BR>
</FONT><TT>QueryParam query = new QueryParam("", ComparisonSpec.GreaterThanOrEqualTo, 99999) ;</TT><FONT FACE="Arial"><BR>
</FONT><TT>INode [] rvn = ((ReportNode)(rn[3])).createList( query );</TT><FONT FACE="Arial"><BR>
<BR>
The ReportVersionNode is a report section list factory. Use it to obtain a list of all sections for a given version:<BR>
<BR>
</FONT><TT>// Get a list of all sections for the version at index 0.</TT><FONT FACE="Arial"><BR>
</FONT><TT>QueryParam query = new QueryParam("", ComparisonSpec.GreaterThanOrEqualTo, 99999) ;</TT><FONT FACE="Arial"><BR>
</FONT><TT>INode [] rsn = ((ReportVersionNode)(rvn[0])).createList( query );</TT><FONT FACE="Arial"><BR>
<BR>
The ReportSectionNode is a report page list node factory. Use it to obtain a list of all pages in a given section:<BR>
<BR>
</FONT><TT>// Get a list of all pages for the section at index 0.</TT><FONT FACE="Arial"><BR>
</FONT><TT>QueryParam query = new QueryParam("", ComparisonSpec.GreaterThanOrEqualTo, 99999) ;</TT><FONT FACE="Arial"><BR>
</FONT><TT>INode [] rpn = ((ReportSectionNode)(rsn[0])).createList( query );</TT><FONT FACE="Arial"><BR>
<BR>
Finally, the ReportPageNode is a page factory. Use it to obtain a page object:<BR>
<BR>
</FONT><TT>// Get a page for the report page node at index 0.</TT><FONT FACE="Arial"><BR>
</FONT><TT>IPage page = ((ReportPageNode)(rpn[0])).createPage();</TT><FONT FACE="Arial"><BR>
<BR>
</div></P>
<H4><A NAME="topitem"></A></A>Navigating the Topic Hierarchy</H4>
<P><div>To navigate the topic hierarchy, first create a topic list factory:<BR><br>
</FONT><TT>// Create a topic list factory.</TT><FONT FACE="Arial"><BR>
</FONT><TT>TopicListFactory tlf = (TopicListFactory)(sess.createListFactory( SessionFactoryType.Topic ));</TT><FONT FACE="Arial"><BR>
</div><div><BR>
</div><div>You can then use it to obtain a list of all topics on all the document servers to which the session is connected:<BR><br>
</FONT><TT>// Get a list of all topics on the servers.</TT><FONT FACE="Arial"><BR>
</FONT><TT>QueryParam query = new QueryParam("", ComparisonSpec.GreaterThanOrEqualTo, 99999) ;</TT><FONT FACE="Arial"><BR>
</FONT><TT>INode [] tn = (tf.createList( query ));</TT><FONT FACE="Arial"><BR>
<BR>
The TopicNode is a topic version node list factory. Use it to obtain a list of all topic versions for a given topic:<BR>
<BR>
</FONT><TT>// Get a list of all topics versions for the topic at index 0.</TT><FONT FACE="Arial"><BR>
</FONT><TT>QueryParam query = new QueryParam("", ComparisonSpec.GreaterThanOrEqualTo, 99999) ;</TT><FONT FACE="Arial"><BR>
</FONT><TT>INode [] tvn = tn[0].createList( query );</TT><FONT FACE="Arial"><BR>
<BR>
The TopicVersionNode is either a topic item list factory or a topic item entry list factory.
As a topic item list factory, you can use it to obtain a list of all topic items for a given topic version:<BR>
<BR>
</FONT><TT>// Get a list of all topics items for the topic at index 0.</TT><FONT FACE="Arial"><BR>
</FONT><TT>QueryParam query = new QueryParam("", ComparisonSpec.GreaterThanOrEqualTo, 99999) ;</TT><FONT FACE="Arial"><BR>
</FONT><TT>INode [] tin = ((TopicVersionNode)(tvn.[0])).createList( query );</TT><FONT FACE="Arial"><BR>
<BR>
As a topic item entry list factory, you can use it to obtain a list of all topic item entries for a given topic version:
<BR><br>
</FONT><TT>// Get a list of all topics items entries for the topic at index 0.</TT><FONT FACE="Arial"><BR>
</FONT><TT>TopicItemEntryQueryParam query = new TopicItemEntryQueryParam("","","",0, ComparisonSpec.GreaterThanOrEqualTo, 99999) ;
</TT><FONT FACE="Arial">
</FONT><TT>INode [] tien = ((TopicVersionNode)(tvn.[0])).createList( query );</TT><BR>
<BR><font face="Arial, Helvetica, sans-serif">
<b>Note:</b> Topic item lists are useful if you are traversing the topic hierarchy and seek high level information about
topic versions. Topic item entry lists are useful if you are seeking detailed information about topic items with multiple report versions.
<p>
The TopicItemNode is a topic report node list factory. Use it to obtain a list of all topic reports for a given topic item:</font><BR>
<BR>
<TT>// Get a list of all topics reports for the topic item at index 0.</TT><FONT FACE="Arial"><BR>
</FONT><TT>QueryParam query = new QueryParam("", ComparisonSpec.GreaterThanOrEqualTo, 99999) ;</TT><FONT FACE="Arial"><BR>
</FONT><TT>INode [] trn = ((TopicItemNode)(tin[0])).createList( query );</TT><FONT FACE="Arial"><BR>
<BR>
The TopicReportNode is a topic report version node list factory. Use it to obtain a list of all topic report versions for a given topic report:<BR>
<BR>
</FONT><TT>// Get a list of all topics report versions for the topic report at index 0.</TT><FONT FACE="Arial"><BR>
</FONT><TT>QueryParam query = new QueryParam("", ComparisonSpec.GreaterThanOrEqualTo, 99999) ;</TT><FONT FACE="Arial"><BR>
</FONT><TT>INode [] trvn = ((TopicReportNode)(trn[0])).createList( query );</TT><FONT FACE="Arial"><BR>
<BR>
The TopicReportVersionNode is a topic section node list factory. Use it to obtain a list of all topic sections for a given topic report version:<BR>
<BR>
</FONT><TT>// Get a list of all topics sections for the topic report version at index 0.</TT><FONT FACE="Arial"><BR>
</FONT><TT>QueryParam query = new QueryParam("", ComparisonSpec.GreaterThanOrEqualTo, 99999) ;</TT><FONT FACE="Arial"><BR>
</FONT><TT>INode [] tsn = ((TopicReportVersionNode)(trvn[0])).createList( query );</TT><FONT FACE="Arial"><BR>
<BR>
The TopicSectionNode is a report page node list factory. Use it to obtain a list of all report pages for a given topic section:<BR>
<BR>
</FONT><TT>// Get a list of all report pages for the topic section at index 0.</TT><FONT FACE="Arial"><BR>
</FONT><TT>QueryParam query = new QueryParam("", ComparisonSpec.GreaterThanOrEqualTo, 99999) ;</TT><FONT FACE="Arial"><BR>
</FONT><TT>INode [] rpn = ((TopicSectionNode)(tsn[0])).createList( query );</TT><FONT FACE="Arial"><BR>
<BR>
Finally, the ReportPageNode is a page factory. Use it to obtain a page object:<BR>
<BR>
</FONT><TT>// Get a page for the report page node at index 0.</TT><FONT FACE="Arial"><BR>
</FONT><TT>IPage page = ((ReportPageNode)(rpn[0])).createPage();</TT><FONT FACE="Arial"><BR>
<BR>
</div></P>

<p><a href="topitem.html">View sample code for retrieving specific pages from a Topic Item
section.</a>


<H3><A NAME="Heading272"><A NAME="_Toc508756859"></A></A>Using the Enhanced Topic Item Search and Filter Query Facility</H3>
<P>
<div>The new enhanced topic item search facility is supported by the existing SearchTopicItemListFactory.
<BR><br>
</div>
<div>
To create a search topic item list factory:<br>
</FONT><TT>IListFactory sti = session.createListFactory(SessionFactoryType.SearchTopicItems);</TT><FONT FACE="Arial"><BR>
<br>A combination of VdrSearchExpression and VdrSearchTerm classes are used to create enhanced topic item search expressions.
<br>The VdrSearchTerm class is an abstract class that can represent a search term or a sub-expression.
<br>A search term contains:
<br>An Attribute or field (e.g., TopicID, SectionID, etc.), a comparison operator (e.g., GreaterThan, EqualTo, etc.), and comparing value(s).<br>
<br>A sub-expression contains a VdrSearchExpression.<br>
<br>A set of concrete classes are used to create search terms. These are:
<ul>
<li>TopicSearchTerm -a TopicID search term
<li>ReportSearchTerm - a ReportID search term
<li>VersionSearchTerm - a VersionID search term
<li>SectionSearchTerm - a SectionID search term
<li>SubExpressionSearchTerm - a VdrSearchExpression sub-expression
</ul>
To create a search term instance, define the term (the attribute or field, the comparison operator * and comparing value or values) and call the proper search term constructor.
<br>* Important: Valid operators for a search term are restricted to the query submitted, and only those comparison operators defined within the query can be used.
<br>For example, to build a search term for an EnhancedSearchTopicItemQueryParam instance, only those static comparison operators defined within the EnhancedSearchTopicItemQueryParam class can be used.
<br><br>Here are some code examples:
<br>
Create a SectionID search term for an EnhancedSearchTopicItemQueryParam query:<BR>
</FONT><TT>SectionSearchTerm term1 = new SectionSearchTerm( EnhancedSearchTopicItemQueryParam.LE ,"0003");</TT><FONT FACE="Arial"><BR>
Create a TopicID search term for an EnhancedSearchTopicItemQueryParam query:<BR>
</FONT><TT>TopicSearchTerm   term2 = new TopicSearchTerm("ACCTCD", EnhancedSearchTopicItemQueryParam.GT ,"1234");</TT><FONT FACE="Arial"><BR>
<br>A VdrSearchExpression instance represents an enhanced topic item search expression. It contains either a VdrSearchTerm or a VdrSearchExpression sub-expression, joined by 'AND' or 'OR' conjunction operators.
<br>To create a VdrSearchExpression  object, either call its constructor with the appropriate conjunction:
</FONT><TT><br>VdrSearchExpression andSearchExp = new VdrSearchExpression(SearchConjunction.AND);</TT><FONT FACE="Arial"><BR>
<br>Or call the static helper method:
</FONT><TT><br>VdrSearchExpression andSearchExp = VdrSearchExpression.createAndExpression();</TT><FONT FACE="Arial"><BR>
<br>Adding search terms is performed by calling the expression's addTerm() method.
</FONT><TT>andSearchExp.addTerm(term1);</TT><FONT FACE="Arial"><BR>
</FONT><TT>andSearchExp.addTerm(term2);</TT><FONT FACE="Arial"><BR>
<br>A ResultOptions instance represents a group of result-set options applied while performing an enhanced topic item search. These options include:
<ul>
<li>Topic grouping
<li>Whether document references are returned
<li>Which result columns are to be returned and their order
<li>How to consolidate results
<li>Method of Search
<li>The request count
</ul>
To create ResultOptions with default values:<br>
</FONT><TT>ResultOptions resOptions = new ResultOptions();</TT><FONT FACE="Arial"><BR>
<br>ResultOptions default values are:
<ol>
<li>Topics are grouped by SEARCHCRITERIA (Requests the return of values for all topics specified as search criteria. The return values also include the report, report version and section for the returned matches)
<li>Document References will be returned (full document details)
<li>Result consolidation is by PAGERANGE (Consolidates consecutive matching pages into a single search result)
<li>Search Operation mode is SEARCH (Returns all occurrences of each matching topic item value)
</ol>
The request count is always required (can also be set within the ResultOptions instance).<br>
<br>Create an instance of EnhancedSearchTopicItemQueryParam with the enhanced search expression, request count and the result options as parameters:<br>
</FONT><TT>qParam = new EnhancedSearchTopicItemQueryParam(andSearchExp, reqCount, resOptions);</TT><FONT FACE="Arial"><BR>
<br>
Submitting an instance of EnhancedSearchTopicItemQueryParam as a parameter to the SearchTopicItemListFactory's createList method signifies an enhanced topic item search, and will return an array of EnhancedSearchTopicItemNode objects.<br>
</FONT><TT>
<pre>
EnhancedSearchTopicItemNode estin = null;
INode[] enodes = null;
try {
  enodes = sti.createList(qParam);
}
catch(DataNotFoundException dnfe) {
  ...
}
// process EnhancedSearchTopicItemNode objects
for ( int i = 0; i < nodes.length; i++ ) {
  estin = (EnhancedSearchTopicItemNode)nodes[i];
  ...
}
</pre>
</TT><FONT FACE="Arial">
<br>Each EnhancedSearchTopicItemNode object represents one row.
</div>

<H3><A NAME="Heading271"><A NAME="_Toc508756857"></A></A>Using the Enterprise Query Facility</H3>
<P><div>Use the SearchTopicItemsListFactory to return a list of pages meeting some specific criteria:<BR><br>
</FONT><TT>// Create a search topic item list factory.</TT><FONT FACE="Arial"><BR>
</FONT><TT>SearchTopicItemsListFactory stilf = (SearchTopicItemListFactory) hSession.createListFactory( SessionFactoryType.SearchTopicItems );</TT><FONT FACE="Arial"><BR>
</div><div><BR>
</div><div>The SearchTopicItemListFactory is an ISearchTopicItemResult list factory. Use it to create a list of ISearchTopicItemResult objects:<BR>
</div><div><BR>
</FONT><TT>SearchTopicItemQueryParam squeryParam = new SearchTopicItemQueryParam(null, null, 10) ;</TT><FONT FACE="Arial"><BR>
<BR>
</FONT><TT>// Just create some default search constraints</TT><FONT FACE="Arial"><BR>
</FONT><TT>TopicSearchConstraint [] searchConstraint = new TopicSearchConstraint[1] ;</TT><FONT FACE="Arial"><BR>
<BR>
</FONT><TT>// Set fields</TT><FONT FACE="Arial"><BR>
</FONT><TT>searchConstraint[0] = new TopicSearchConstraint() ;</TT><FONT FACE="Arial"><BR>
</FONT><TT>searchConstraint[0].topicIdConstraint.target1 = "ACCTCHK" ;</TT><FONT FACE="Arial"><BR>
</FONT><TT>searchConstraint[0].topicIdConstraint.comparison = SQLComparisonSpec.EqualTo ;</TT><FONT FACE="Arial"><BR>
</FONT><TT>searchConstraint[0].topicItemConstraint.target1 = "543" ;</TT><FONT FACE="Arial"><BR>
</FONT><TT>searchConstraint[0].topicItemConstraint.comparison = SQLComparisonSpec.GreaterThanOrEqualTo ;</TT><FONT FACE="Arial"><BR>
<BR>
</FONT><TT>// Set this search constraint as the topic constraint</TT><FONT FACE="Arial"><BR>
</FONT><TT>squeryparam.setTopicSearchConstraints(searchConstraint) ;</TT><FONT FACE="Arial"><BR>
<BR>
</FONT><TT>INode [] stin = (stilf.createList(squeryParam));</TT><FONT FACE="Arial"><BR>
</div><div><BR>
Finally, the ISearchTopicItemResult is a page factory. Use it to obtain a page object:<BR>
<BR>
</FONT><TT>// Get a page for the report page node at index 0.</TT><FONT FACE="Arial"><BR>
</FONT><TT>IPage page = (IPage)((IPageFactory(stin[0])).createPage();</TT><FONT FACE="Arial"><BR>
</div><div><BR>
</div></P>
<H2><A NAME="Heading300"><A NAME="_Toc508756858"></A></A>Error Handling</H2>
<P><div>Error handling in the ViewDirect API for Java is managed by throwing and catching exceptions. An extensive set of exceptions has been defined to describe the possible errors that can occur while using the API. The thrown exceptions all derive from the ViewDirectException class. Consult the <a href="index.html">documentation</a> for the various API classes for details of the specific exceptions thrown.</P>
<P>When using the API, you must execute methods of classes that throw exceptions within the context of a "try-catch" block, or the code will not compile.<BR>
<BR>
</div></P></FONT>

<a name="appsetup"></a><H2>Setup Verification</H2>

<P><div>The ViewDirect API for Java provides tools to help verify that you set up your Web application correctly. <ul><li>The ApiInitializer class automates certain configuration tasks that must be performed prior to deploying your application, such as ensuring that the application points to the required library files <li>The ApiVerifier class contains specific tests to help verify that the system environment for your is set up correctly<li>The ApiVerfierResult class lets you can review additional information about the outcomes of these tests</ul> <p>Consult the <a href="index.html">documentation</a> for these classes for further details.</p>
</div>

<a name="Migration21to42"></a><H2>Migrating from ViewDirect API for Java version 2.1 to version 4.2</H2>

<P><div>This section describes changes that must be made in order for your code to work when upgrading from ViewDirect API for Java version 2.1 to version 4.2.</div>

<H3><A NAME="Heading400"></A>Required Code Changes</H3>

<I><H4><A NAME="Heading401"></A>com.mobius.vdrapi.IHasProfileLocation.java</H4></I>

<P><div>Interface IHasProfileLocation.java now has only one method</div>
<BR>
<ul><li>public String getProfileLocation();</ul>
<P><div>which returns the name of the profile XML file. This new method replaces the old getPrimaryLocation() and getSecondaryLocation() methods from version 2.1.
</div><BR>
<P><div>Any existing code that implements this interface must be modified to have a getProfileLocation() method otherwise MethodNotFound Exceptions shall occur and your code will not run.</div>
</div>

<I><H4><A NAME="Heading402"></A>com.mobius.vdrapi.IDocumentServer.java</H4></I>

<P><div>Interface IDocumentServer.java contains new methods in version 4.2.</div>
<BR>
<ul><li>public boolean getAllowMixedCaseLogin() ;<li>public void setAllowMixedCaseLogin(boolean value) throws DataIOException;</ul>
<P><div>These methods set and get the flag that indicates whether or not the document server is configured for mixed case login.
</div><BR>
<P><div>If any existing code is implementing this interface it needs to be modified to implement the above methods otherwise MethodNotFound Exceptions shall occur and your code will not run.
</div>

<I><H4><A NAME="Heading403">com.mobius.vdrapi.IPage.java</H4></I>

<P><div>Interface IPage.java contains new methods in version 4.2 some of which are deprecated.  If any of your code is implementing this interface it will no longer run under 4.2 so it is necessary that it be changed to no longer implement this interface.  Instead of implementing this interface it is more desirable to have your code reference the Page.java and its subclasses (i.e. AFPPage.java, PDFPage.java etc…) directly.
</div>

<I><H4><A NAME="Heading404">com.mobius.vdrapi.IRenderUsingPresentation.java</H4></I>

<P><div>Interface IRenderUsingPresentation.java is now deprecated in version 4.2.  If any of your code is implementing this interface it will no longer run under 4.2 so it is necessary that it be changed to no longer implement this interface.  Instead of implementing this interface it is more desirable to have your code reference one of the page view classes that supports presentations (i.e. LPFDPageView.java) directly.
</div>

<H3><A NAME="Heading410"></A>Optional Code Changes</H3>

<P><div>The PolicyListFactory.java and XMLPageView.java classes are now deprecated in version 4.2.  Your code may continue to reference these classes as there are no changes that should affect existing code.  Be aware that referencing deprecated classes is not recommended as in future versions these classes may be removed which would then cause ClassDefNotFound errors at run-time.
</div>

<H3><A NAME="Heading420"></A>Recompiling Custom Applications</H3>

<P><div>If any of your code was modified it is required that the application be recompiled with the new ViewDirect API for Java 4.2 jar file to ensure there are no compilation errors.
</div><BR>
<P><div>If no code has been modified, then it is recommended, yet not required, that the application be recompiled with the new ViewDirect API for Java 4.2 jar file.
</div>

</BODY>
</HTML>
